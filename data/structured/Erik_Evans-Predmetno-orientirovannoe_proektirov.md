


рик BaHC Преgисловие Мартина ФаУflера Предметно-ориентированное П оекти ОБ иие еТРУКТУРИ3АЦИЯ ел О жныIx ПРО rPAMMHbIX СИ еТЕМ Domain -Driven Design TACKLING COMPLEXITY IN ТНЕ HEART OFSOFTWARE Eric Evans

.ŝ'" Addison-Wesley Boston • San Francisco • New York • Toronto Muntreal • London • Munich • Paris • Madrid Capetown • Sydney • Tokyo • Singapore • Mexico City Предметно-ориентированное П оекти ование СТРУRТУРИ3АЦИЯ СЛОЖНЫХ

ПРО ГРАММНЫХ СИСТЕМ 3рик 3ванс • Издательский дом "Вильяме" Москва • Санкт-Петербург • Киев 2011 ББК 32.973.26-018.2.75 Э14 УДК 68 1.3.07 Издательский дом "Вильяме" Зав. редакцией С.Н. Трuгуб Перевод с английского и редакция в.л. БродовОlО

По общим вопросам обращайтесь в Издательский дом "Вильяме" по адресу: info@williamspublishing.com, http://www.williamspublishing.com Эванс, Эрик. Э14 Предметно-ориентированное проектирование (DDD): структуризация сложных

программных систем. : Пер. с англ. - М.: 000 "И.Д. Вильямс", 2011. - 448 с. : ил. - Парал. тит. англ. ISBN 978-5-8459-1597-9 (рус.) ББК 32.973.26-018.2.75 Все наX-шания прuграммных продуктов являются зарегистрированными торговыми марками соответствующих фирм.

Никакая часть настоящего издания ни в каких целях не может быть воспроизведена в какой бы то ни было форме и какими бы то ни было средствами, будь то электронные или механические, включая фотокопирование и эапись на маг­

нитный носитель, если на это нет письменного разрешения издательства Addison-Wesley PubIishing Сошрапу, Inc. Authorized translation from the English language edition published Ьу Addison-Weslcy Publishillg Сатрапу, Iпс,

Copyright © 2004 Ьу Eric Еvапs. АН rights reserved. No part of this publication тау Ье reproduced, stored in а retrieval sуstеш, or transmitted, in апу fоrш, or Ьу апу шеапs, elcctrunic, mechanical, photocopying, recording, or otherwise, without the prior consent of the puhlisher.

Russian language edition pllblished Ьу Williams Publishing House according t:o the Agrcement witll R&I Enterprises International, Copyright © 2011 Научно-популярное издание Эрик Эванс Предметно-ориентированное проектирование (DDD):

структуризация сложных программных систем Литературный редактор Верстка Художественный редактор Корректор Е.П. Перестюк О.В. РомаllеllКО в.г. ПавлютUll Л.А. ГордиеllКО Подписано в печать 26.08.2010. Формат 70х100/16.

Гарнитура Times. Печать офсетная. Уел. печ. л. 36,12. Уч.-изд. л. 31,4. Тираж 1000 экз. Заказ N2 23564. Отпечатано по технологии CtP в ОАО "Печатный двор" им. А. М. Горького 197110, Санкт-Петербург, Чкаловекий пр., 15.

000 "и. Д. Вильяме", 127055, г. Москва, ул. Лесная, д. 43, стр. 1 ISBN 978-5-8459-1597-9 (рус.) ISBN 978-0-321-12521-7 (англ.) © Издательский дом "Вильяме", 2011 © Ьу Eric Evans, 2004 Оглавление Введение

ЧАСТЬ 1. МОДЕЛЬ ПРЕДМЕТНОЙ ОБЛАСТИ В РАБОТЕ Глава 1. Переработка знаний Глава 2. Коммуникация и язык Глава 3. Связь между моделью и реализацией ЧАСТЬ 11. СТРУКТУРНЫЕ ЭЛЕМЕНТЫ ПРЕДМЕТНО-ОРИЕНТИРОВАННОГО ПРОЕКТИРОВАНИЯ

Глава 4. Изоляция предметной области Глава 5. Модель, выраженная в программе Глава 6. Цикл существования объектов модели Глава 7. Работа с языком: расширенный пример ЧАСТЬ 111. УГЛУБЛЯЮЩИЙ РЕФАКТОРИНГ Глава 8. Качественный скачок

Глава 9. Перевод неявных понятий в явные Глава 10. Гибкая архитектура Глава 11. Применение аналитических шаблонов Глава 12. Шаблоны и модель Глава 13. Углубляющий рефакторинг чАсты.стрАтЕгичЕскоЕпроЕктировАниЕE

Глава 14. Поддержание целостности модели Глава 15. Дистилляция Глава 16. Крупномасштабная структура Глава 17. Объединение стратегических подходов Заключение Приложение. Использование шаблонов в этой книге

Глоссарий Список литературы Фотографии Предметный указатель 17 27 33 45 61 75 79 89 123 153 175 181 191 221 263 275 287 291 295 345 375 411 423 429 433 437 438 439 Содержание Введение ЧАСТЬ 1. МОДЕЛЬ ПРЕДМЕТНОЙ ОБЛАСТИ В РАБОТЕ

Роль и выбор модели Алгоритмическая часть программы Глава 1. Переработка знаний Составляющие эффективного моделирования Переработка знаний Непрерывное обучение Информоемкая архитектура Извлечение скрытого понятия

Углубленные модели Глава 2. Коммуникация и язык Единый язык đоделирование вслух Одна команда - один язык Документация, диаграммы, схемы Письменная проектная документация Выполняемый код решает все Пояснительные модели

Глава з. Связь между моделью и реализацией Проектирование по модели Парадигмы моделирования и средства программирования Анатомия модели: зачем модель нужна пользователю Моделировщики -практики ЧАСТЬ 11. СТРУКТУРНЫЕ ЭЛЕМЕНТЫ

ПРЕДМЕТНО-ОРИЕНТИРОВАННОГО ПРОЕКТИРОВАНИЯ Глава 4. Изоляция предметной области Многоуровневая архитектура Связь между уровнями Архитектурные среды Уровень предметной области - вместилище модели "Антишаблон" интеллектуального интерфейса пользователя

Другие виды изоляции 17 27 29 30 зз 37 38 39 40 41 43 45 45 50 51 53 55 57 58 61 62 65 71 72 75 79 79 83 84 85 85 88 Глава 5. Модель, выраженная в программе 89 А{:социации 90 Сущности (указуемые объекты)

95 Моделирование СУЩНОСТЕЙ 98 Проектирование операций идентификации 99 Объекты-значения 101 Проектирование ОБЪЕКТОВ-ЗНАЧЕНИЙ 103 Проектирование ассоциаций с помощью ОБЪЕКТОВ-ЗНЛ ЧЕНИЙ 106 Службы 107 Службы и изоляция уровня предметной области

108 Степень модульности 110 Доступ к службам 11 О Модули (пакеты) 111 Гибкая модульность 112 Ловушки инфраструктуры 114 Парадигмы моделирования 116 Причины доминирования объектной парадигмы 117 Не-объекты в объектном мире

119 ПРОЕКТИРОВЛНИЕ ПО МОДЕЛИ в условиях смешения парадигм 119 Глава 6. Цикл существования объектов модели 123 Агрегаты 124 Фабрики 133 Выбор фабрик и их местонахождения 135 Когда достаточно конструктора

137 Проектирование интерфейса 138 Где реализовать логику инвариантов? 139 Отличия между фабриками сущностей и фабриками объектов-значений 139 Восстановление хранимых объектов 139 Хранилища 141 Запросы к хранилищам

145 Клиентам безразлична реализация хранилищ, а разработчикам - нет 147 Реализация хранилища 147 Работа в рамках архитектурной среды 149 Связь с фабриками 149 Проектирование объектов для реляционной базы данных

151 Глава 7. Работа с языком: расширенный пример 153 Введение в систему управления доставкой 153 Изоляция предметной области: добавление прикладных операций 155 Отделение сущностей от значений 156 Роль и другие атрибуты

157 Проектирование ассоциаций в модели 157 Границы агрегатов 158 Выбор хранилищ 159 Проход по сценариям 160 СОДЕРЖАНИЕ 7 Пример рабочей функции: изменение места назначения груза Пример рабочей функции: повторение заказов

Создание объектов Фабрики и конструкторы для объекта Груз Добавление объекта Манипуляция Перерыв на рефакторинг: альтернативный агрегат Груз Модули в модели грузопоставок Новая функция: распределение заказов

Связь между двумя системами Усовершенствование модели: введение подразделений Оптимизация быстродействия Итоги ЧАСТЬ 111. УГЛУБЛЯЮЩИЙ РЕФАКТОРИНГ Уровни рефакторинга Углубленные модели Углубленная модель и гибкая архитектура

Процесс познания Глава 8. Качественный скачок История успеха Модель неплоха, но ... Скачок Углубленная модель Трезвое решение Воздаяние Потенциал Концентрация на основах Каскад озарений Глава 9. Перевод неявных понятий в явные

Извлечение понятий Внимание к языку Выявление узких мест Размышление над противоречиями Чтение книг Метод проб и ошибок Моделирование неочевидных понятий Явные условия-ограничения П роцессы как объекты предметной области

Спецификация Применение и реализация спецификаций Глава 10. Гибкая архитектура Информативные интерфейсы Функции без побочных эффектов 8 160 161 162 162 163 164 166 167 169 170 172 172 175 176 177 178 179

181 182 182 184 185 187 188 188 188 189 191 191 191 195 199 200 202 202 202 204 205 208 221 223 226 СОДЕРЖАI-IИЕ Утверждения Концептуальные контуры Изолированные классы Замкнутость операций Декларативная архитектура

Декларативный стиль архитектуры Углы атаки Выделение подобластей Использование сложившихся формальных систем Глава 11. Применение аналитических шаблонов Аналитические шаблоны как источник знания Глава 12. Шаблоны и модель

Стратегия Композит Почему не "мелкий объект" (flyweight)? Глава 13. Уrлубляющий рефакторинr Инициирование Исследовательские группы Предыдущие наработки Архитектура для разработчиков Расчет времени Кризис как потенциальная возможность

ЧАстьIV. СТРАТЕГИЧЕСКОЕ ПРОЕКТИРОВАНИЕ Глава 14. Поддержание целостности модели Ограниченный контекст Распознавание дефектов внутри ограниченного контекста Непрерывная интеграция Карта контекстов Тестирование в границах контекста

Организация и документирование карт контекстов Взаимосвязи между ограниченными контекстами Общее ядро Группы "заказчик-поставщик" Конформист Предохранительный уровень Проектирование интерфейса предохранительного уровня

Реализация предохранительного уровня Поучительная история Отдельное существование Службы с открытым протоколом Общедоступный язык Унификация слона СОДЕРЖАНИЕ 231 234 238 240 242 245 252 252 253 263 274

275 276 279 284 287 287 288 288 289 289 290 291 295 298 301 302 304 311 311 311 312 313 317 320 321 322 324 325 327 327 330 9 Выбор стратегии построения контекстов 333 Уровень принятия решений: разработчики или выше

333 Помещение самих себя в контекст 333 Преобразование границ 334 Принятие того, что нельзя изменить: контуры внешних систем 334 Взаимоотношения с внешними системами 335 Проектируемая система 335 Учет особых случаев отдельными моделями

336 У становка системы 337 Компромиссы 337 Если проект уже в работе 338 Преобразования 339 Слияние контекстов: от отдельного существования к общему ядру 339 Слияние контекстов: от общего ядра к непрерывной интеграции

340 Вытеснение устаревшей системы 341 От открытого протокола к общедоступному языку 342 Глава 15. ДИСТИЛЛЯЦИЯ 345 Смысловое ядро 347 Выбор ядра 349 Как распределить работу 349 Эскалация дистилляции 350

Неспециализированные подобласти 351 "Неспециализированный" не значит "хорошо переносимый" 356 Управление рисками в проекте 357 Введение в предметную область 357 Схематическое ядро 359 Дистилляционный документ

360 Разметка ядра 361 Дистилляционный документ как методическое средство 362 Связные механизмы 362 Сравнение связных механизмов и неспециализированных подобластей 364 Когда механизм входит в смысловое ядро

365 Дистилляция к декларативному стилю 366 Выделенное ядро 366 Цена создания выделенного ядра 367 Эволюция коллективных решений 368 Абстрактное ядро 373 Дистилляция в углубленных моделях 374 Выбор целей рефакторинга

374 Глава 16. Крупномасштабная структура 375 Эволюционная организация 378 Метафорический образ системы 380 "Наивный образ": почему он нам не нужен 382 Уровни разделения обязанностей 382 10 Выбор подходящих уровней

391 СОДЕРЖАНИЕ Уровень знаний 395 Среда подключаемых компонентов 402 Насколько жесткой должна быть структура 406 Структурирующий рефакторинг 407 Минимализм 408 Коммуникативность и самодисциплина 408 Реструктуризация дает гибкую архитектуру

408 Дистилляция 409 Глава 17. Объединение стратегических подходов 411 Сочетание крупномасштабных структур и ограниченных контекстов 411 Сочетание крупномасштабной структуры и дистилляции 414 Первоначальная оценка

