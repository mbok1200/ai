# Ollama Gemma LoRA Project

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ Gemma-2-2b –∑ LoRA –∞–¥–∞–ø—Ç–µ—Ä–æ–º —á–µ—Ä–µ–∑ Ollama –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ.

## üöÄ –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

- **Ollama**: –õ–æ–∫–∞–ª—å–Ω–∏–π LLM —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫—É –º–æ–¥–µ–ª–µ–π
- **Gemma-2-2b**: –ö–æ–º–ø–∞–∫—Ç–Ω–∞ —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –º–æ–≤–Ω–∞ –º–æ–¥–µ–ª—å –≤—ñ–¥ Google
- **LoRA –∞–¥–∞–ø—Ç–µ—Ä**: –í–∞—à –Ω–∞–≤—á–µ–Ω–∏–π –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è HR/–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –¥–æ–º–µ–Ω—É
- **Docker**: –ü–æ–≤–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
- **FastAPI**: RESTful API –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –º–æ–¥–µ–ª–ª—é
- **Web UI**: –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑—Ä—É—á–Ω–æ—ó —Ä–æ–±–æ—Ç–∏
- **–°—Ç—Ä—ñ–º—ñ–Ω–≥**: –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
ollama-gemma-project/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.py              # –ì–æ–ª–æ–≤–Ω–∏–π FastAPI –¥–æ–¥–∞—Ç–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ ollama_client.py    # –ö–ª—ñ—î–Ω—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Ollama
‚îÇ   ‚îî‚îÄ‚îÄ lora_manager.py     # –ú–µ–Ω–µ–¥–∂–µ—Ä LoRA –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤
‚îú‚îÄ‚îÄ lora_adapter/           # –í–∞—à LoRA –∞–¥–∞–ø—Ç–µ—Ä (–∫–æ–ø—ñ—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
‚îú‚îÄ‚îÄ Dockerfile              # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml      # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤—ñ—Å—ñ–≤
‚îú‚îÄ‚îÄ Modelfile              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ –¥–ª—è Ollama
‚îú‚îÄ‚îÄ requirements.txt        # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ manage.sh              # –°–∫—Ä–∏–ø—Ç –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç–æ–º
‚îî‚îÄ‚îÄ README.md              # –¶–µ–π —Ñ–∞–π–ª
```

## üõ†Ô∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### –ü–µ—Ä–µ–¥—É–º–æ–≤–∏

- Docker —Ç–∞ Docker Compose
- –ú—ñ–Ω—ñ–º—É–º 8GB RAM
- –ù–∞–≤—á–µ–Ω–∏–π LoRA –∞–¥–∞–ø—Ç–µ—Ä —É `/home/mikola/projects/ai/hr-assistant-finetune-1/lora_adapter/`

### –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç—É (–∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è LoRA –∞–¥–∞–ø—Ç–µ—Ä–∞)
./manage.sh setup

# 2. –ó–±—ñ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑—É
./manage.sh build

# 3. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É
./manage.sh start
```

### –î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
./manage.sh setup     # –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç—É
./manage.sh build     # –ó–±—ñ—Ä–∫–∞ –æ–±—Ä–∞–∑—É
./manage.sh start     # –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É
./manage.sh stop      # –ó—É–ø–∏–Ω–∫–∞ –ø—Ä–æ–µ–∫—Ç—É
./manage.sh restart   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
./manage.sh logs      # –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
./manage.sh status    # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤—ñ—Å—ñ–≤
./manage.sh test      # –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è API
./manage.sh clean     # –û—á–∏—â–µ–Ω–Ω—è
./manage.sh help      # –î–æ–≤—ñ–¥–∫–∞
```

## üåê –î–æ—Å—Ç—É–ø–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏

–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏:

- **FastAPI**: http://localhost:8000 - –ì–æ–ª–æ–≤–Ω–∏–π API
- **Ollama API**: http://localhost:11434 - –ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ Ollama
- **Web UI**: http://localhost:3000 - –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —á–∞—Ç—É

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

### –û—Å–Ω–æ–≤–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏

#### GET /
–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ API

#### GET /health
```json
{
  "status": "healthy",
  "ollama_ready": true,
  "lora_loaded": true
}
```

#### GET /models
–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π

#### POST /chat
–ß–∞—Ç –∑ –º–æ–¥–µ–ª–ª—é

**–ó–∞–ø–∏—Ç:**
```json
{
  "message": "–ü—Ä–∏–≤—ñ—Ç! –Ø–∫ —Å–ø—Ä–∞–≤–∏?",
  "temperature": 0.7,
  "max_tokens": 1000,
  "stream": false
}
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "response": "–ü—Ä–∏–≤—ñ—Ç! –£ –º–µ–Ω–µ –≤—Å–µ –¥–æ–±—Ä–µ, –¥—è–∫—É—é. –Ø–∫ —è –º–æ–∂—É –≤–∞–º –¥–æ–ø–æ–º–æ–≥—Ç–∏?",
  "model": "gemma2-hr-assistant",
  "tokens_used": 15
}
```

### –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

#### cURL
```bash
# –ü—Ä–æ—Å—Ç–∏–π —á–∞—Ç
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "–†–æ–∑–∫–∞–∂–∏ –ø—Ä–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–µ –ª—ñ–¥–µ—Ä—Å—Ç–≤–æ", "temperature": 0.7}'

# –°—Ç—Ä—ñ–º—ñ–Ω–≥ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
curl -X POST http://localhost:8000/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "–©–æ —Ç–∞–∫–µ agile –∫–æ—É—á–∏–Ω–≥?", "stream": true}'
```

#### Python
```python
import requests

# –ó–≤–∏—á–∞–π–Ω–∏–π –∑–∞–ø–∏—Ç
response = requests.post("http://localhost:8000/chat", json={
    "message": "–ü–æ—Ä–∞–¥–∏ –∑ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–º–∞–Ω–¥–æ—é",
    "temperature": 0.7
})

result = response.json()
print(result["response"])

# –°—Ç—Ä—ñ–º—ñ–Ω–≥
import requests

response = requests.post(
    "http://localhost:8000/chat",
    json={"message": "–†–æ–∑–∫–∞–∂–∏ –ø—Ä–æ –º–æ—Ç–∏–≤–∞—Ü—ñ—é —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤", "stream": True},
    stream=True
)

for line in response.iter_lines():
    if line:
        print(line.decode('utf-8'))
```

#### JavaScript
```javascript
// –ó–≤–∏—á–∞–π–Ω–∏–π –∑–∞–ø–∏—Ç
fetch('http://localhost:8000/chat', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        message: '–Ø–∫ –ø—Ä–æ–≤–µ—Å—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—É –∑—É—Å—Ç—Ä—ñ—á?',
        temperature: 0.7
    })
})
.then(response => response.json())
.then(data => console.log(data.response));

// –°—Ç—Ä—ñ–º—ñ–Ω–≥ –∑ fetch
fetch('http://localhost:8000/chat', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        message: '–ü—Ä–∏–Ω—Ü–∏–ø–∏ lean –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É',
        stream: true
    })
})
.then(response => {
    const reader = response.body.getReader();
    function read() {
        reader.read().then(({done, value}) => {
            if (done) return;
            console.log(new TextDecoder().decode(value));
            read();
        });
    }
    read();
});
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### Modelfile
–§–∞–π–ª `Modelfile` –º—ñ—Å—Ç–∏—Ç—å –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –º–æ–¥–µ–ª—ñ –¥–ª—è Ollama:

```dockerfile
FROM gemma2:2b

PARAMETER temperature 0.7
PARAMETER top_p 0.9
PARAMETER top_k 40
PARAMETER repeat_penalty 1.1

SYSTEM """
–í–∏ - –∫–æ—Ä–∏—Å–Ω–∏–π AI –∞—Å–∏—Å—Ç–µ–Ω—Ç, –Ω–∞–≤—á–µ–Ω–∏–π –Ω–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö –¥–∞–Ω–∏—Ö –∑ HR —Ç–∞ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É.
"""
```

### Docker Compose
–£ `docker-compose.yml` –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏:
- –ü–æ—Ä—Ç–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤
- –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
- Volumes –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è LoRA

–í–∞—à LoRA –∞–¥–∞–ø—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–Ω—Ç–µ–≥—Ä—É—î—Ç—å—Å—è –∑ –±–∞–∑–æ–≤–æ—é –º–æ–¥–µ–ª–ª—é. –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∞–¥–∞–ø—Ç–µ—Ä–∞:

- **–ë–∞–∑–æ–≤–∞ –º–æ–¥–µ–ª—å**: google/gemma-2-2b
- **LoRA rank**: 8
- **LoRA alpha**: 16
- **Dropout**: 0.05
- **–¶—ñ–ª—å–æ–≤—ñ –º–æ–¥—É–ª—ñ**: q_proj, k_proj, gate_proj, o_proj, up_proj, v_proj, down_proj

## üìä –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
```bash
./manage.sh status
```

### –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
```bash
./manage.sh logs
```

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è API
```bash
./manage.sh test
```

## üö® –£—Å—É–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Ollama –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏
./manage.sh logs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ–µ–∫—Ç
./manage.sh restart
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å Ollama
curl http://localhost:11434/api/tags

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –∑ –æ—á–∏—â–µ–Ω–Ω—è–º
./manage.sh clean
./manage.sh setup
./manage.sh build
./manage.sh start
```

### –ü—Ä–æ–±–ª–µ–º–∞: LoRA –∞–¥–∞–ø—Ç–µ—Ä –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π
–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –∞–¥–∞–ø—Ç–µ—Ä –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É:
```
/home/mikola/projects/ai/hr-assistant-finetune-1/lora_adapter/
```

## üìà –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –°–∏—Å—Ç–µ–º–Ω—ñ –≤–∏–º–æ–≥–∏
- **–ú—ñ–Ω—ñ–º—É–º**: 8GB RAM, 4 CPU cores
- **–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ**: 16GB RAM, 8 CPU cores
- **GPU**: –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏
- `0.1-0.3`: –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- `0.7`: –ó–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
- `0.9-1.0`: –ö—Ä–µ–∞—Ç–∏–≤–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

## üîê –ë–µ–∑–ø–µ–∫–∞

### –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ HTTPS
- –î–æ–¥–∞–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
- –û–±–º–µ–∂—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ API
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω
```bash
# –ó–º—ñ–Ω—ñ—Ç—å –ø–æ—Ä—Ç–∏ —É docker-compose.yml
# –î–æ–¥–∞–π—Ç–µ nginx —è–∫ reverse proxy
# –ù–∞–ª–∞—à—Ç—É–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏
```

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–ü—Ä–∏ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: `./manage.sh logs`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å: `./manage.sh status`
3. –°–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫: `./manage.sh restart`
4. –£ –∫—Ä–∞–π–Ω—å–æ–º—É –≤–∏–ø–∞–¥–∫—É: `./manage.sh clean` —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —Ç–∞ –¥–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫–∏—Ö —Ü—ñ–ª–µ–π.
